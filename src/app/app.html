<!-- Loading overlay -->
@if (isLoadingPlugins()) {
  <div class="loading-overlay">
    <div class="loading-content">
      <div class="loading-spinner"></div>
      <h2>Loading Alpha Solve</h2>
      <p>Initializing Python environment and loading plugins...</p>
      @if (pluginError()) {
        <div class="loading-error">
          <strong>Error:</strong> {{ pluginError() }}
        </div>
      }
    </div>
  </div>
}

<div class="app-container">
  <aside class="sidebar" [style.width.px]="sidebarWidth()">
    <div class="sidebar-header">
      <h2>{{ title() }}</h2>
      <div class="project-info">
        @if (isEditingProjectName()) {
          <input
            type="text"
            class="project-name-input"
            [(ngModel)]="project.name"
            (blur)="finishEditingProjectName()"
            (keydown)="onProjectNameKeyDown($event)"
            #projectNameInput
            [autofocus]="true"
          />
        } @else {
          <span class="project-name" (click)="startEditingProjectName()">{{ project.name }}</span>
        }
        <div class="project-actions">
          <button class="project-action-btn" (click)="downloadProject()" title="Download project">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M8 11L4 7H6.5V2H9.5V7H12L8 11Z" fill="currentColor"/>
              <path d="M2 13H14V14H2V13Z" fill="currentColor"/>
            </svg>
          </button>
          <button class="project-action-btn" (click)="triggerFileUpload()" title="Upload project">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M8 5L12 9H9.5V14H6.5V9H4L8 5Z" fill="currentColor"/>
              <path d="M2 3H14V2H2V3Z" fill="currentColor"/>
            </svg>
          </button>
        </div>
      </div>
    </div>
    <app-cell-list
      [cells]="project.cells"
      (cellSelected)="onCellSelected($event)"
      (cellUpdated)="onCellUpdated($event)" />
    <div class="resize-handle" (mousedown)="onResizeStart($event)"></div>
  </aside>

  <main class="main-content">
  </main>
  </div>

<router-outlet />
